[["ebullition-analysis.html", "Chapter 6 Ebullition Analysis", " Chapter 6 Ebullition Analysis library(lme4) library(glmmTMB) library(&quot;AICcmodavg&quot;) eb_all &lt;- bind_rows(sister3_pts_22_eb %&gt;% mutate(Site =&quot;Sister3&quot;), pick_pts_13_eb, catfish_pts_18_eb %&gt;% dplyr::select(-c(catfish_dist_1, catfish_dist_2)), catfish_pts_06_eb %&gt;% dplyr::select(-c(catfish_dist_1, catfish_dist_2)), deans_pts_30_eb %&gt;% dplyr::select(-c(deans_dist_1, deans_dist_2)), deans_pts_16_eb%&gt;% dplyr::select(-c(deans_dist_1, deans_dist_2))) %&gt;% mutate(Site = as.factor(Site)) cor.test(eb_all$Depth, eb_all$inlet_dist, method = &quot;spearman&quot;) ## Warning in cor.test.default(eb_all$Depth, eb_all$inlet_dist, method = &quot;spearman&quot;): Cannot compute exact p-value with ties ## ## Spearman&#39;s rank correlation rho ## ## data: eb_all$Depth and eb_all$inlet_dist ## S = 232420659, p-value &lt; 2.2e-16 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## 0.3853327 ggplot(eb_all, aes(Depth, ch4_eb_g_m2_hr, color = Site)) + geom_point() ## Warning: Removed 102 rows containing missing values (geom_point). ggplot(eb_all, aes(inlet_dist, ch4_eb_g_m2_hr, color = Site)) + geom_point() ## Warning: Removed 99 rows containing missing values (geom_point). # no random effects and no zeros because gamma can&#39;t handle zeros mod1 &lt;- glm(ch4_eb_g_m2_hr ~ Depth + inlet_dist, data = eb_all %&gt;% filter(ch4_eb_g_m2_hr &gt; 0), family = Gamma(link = &quot;log&quot;)) summary(mod1) ## ## Call: ## glm(formula = ch4_eb_g_m2_hr ~ Depth + inlet_dist, family = Gamma(link = &quot;log&quot;), ## data = eb_all %&gt;% filter(ch4_eb_g_m2_hr &gt; 0)) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -3.0371 -1.3024 -0.7659 0.1164 6.1579 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -4.955195 0.130820 -37.878 &lt; 2e-16 *** ## Depth -0.429294 0.085340 -5.030 6.46e-07 *** ## inlet_dist 0.007717 0.001280 6.031 2.84e-09 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for Gamma family taken to be 3.338868) ## ## Null deviance: 1051.4 on 606 degrees of freedom ## Residual deviance: 946.0 on 604 degrees of freedom ## (3 observations deleted due to missingness) ## AIC: -4870.2 ## ## Number of Fisher Scoring iterations: 20 # with random effects but still no zeros mod2 &lt;- glmer(ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(ch4_eb_g_m2_hr &gt; 0) %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), family = Gamma(link = &quot;log&quot;)) summary(mod2) ## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;] ## Family: Gamma ( log ) ## Formula: ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1 | Site) + (1 | trip_wr) ## Data: eb_all %&gt;% filter(ch4_eb_g_m2_hr &gt; 0) %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -4952.8 -4926.3 2482.4 -4964.8 601 ## ## Scaled residuals: ## Min 1Q Median 3Q Max ## -0.6364 -0.4951 -0.3359 0.0261 10.5437 ## ## Random effects: ## Groups Name Variance Std.Dev. ## trip_wr (Intercept) 0.1762 0.4198 ## Site (Intercept) 1.0532 1.0263 ## Residual 2.4247 1.5572 ## Number of obs: 607, groups: trip_wr, 9; Site, 4 ## ## Fixed effects: ## Estimate Std. Error t value Pr(&gt;|z|) ## (Intercept) -5.05321 0.34450 -14.668 &lt;2e-16 *** ## Depth_scale -0.13147 0.05893 -2.231 0.0257 * ## inlet_dist_scale -0.04844 0.09207 -0.526 0.5988 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Correlation of Fixed Effects: ## (Intr) Dpth_s ## Depth_scale 0.008 ## inlt_dst_sc -0.025 -0.604 # hurdle-model gamma regression with random effects and scaled fixed effects # predictors generating structural zeros mod3 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~., family = ziGamma) summary(mod3) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1 | Site) + (1 | trip_wr) ## Zero inflation: ~. ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -3296.2 -3240.0 1659.1 -3318.2 1209 ## ## Random effects: ## ## Conditional model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 9877.6 99.39 ## trip_wr (Intercept) 707.5 26.60 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Zero-inflation model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 0.2912 0.5397 ## trip_wr (Intercept) 0.1374 0.3707 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Dispersion estimate for Gamma family (sigma^2): 1.16 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 182.4617 51.2839 3.558 0.000374 *** ## Depth_scale -2.7552 5.5913 -0.493 0.622184 ## inlet_dist_scale 0.1645 5.8305 0.028 0.977497 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -0.15342 0.30507 -0.503 0.61503 ## Depth_scale 0.23046 0.07787 2.959 0.00308 ** ## inlet_dist_scale 0.16593 0.11088 1.496 0.13454 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 # without random effects, fixed effects not scaled mod4 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth + inlet_dist, data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~., family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation summary(mod4) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ Depth + inlet_dist ## Zero inflation: ~. ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -3178.3 -3142.5 1596.1 -3192.3 1213 ## ## ## Dispersion estimate for Gamma family (sigma^2): 1.35 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 161.89084 11.61723 13.935 &lt; 2e-16 *** ## Depth 17.89632 6.26868 2.855 0.00431 ** ## inlet_dist -0.54291 0.06329 -8.578 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -0.206543 0.111642 -1.850 0.06431 . ## Depth 0.293629 0.066323 4.427 9.54e-06 *** ## inlet_dist -0.003043 0.001147 -2.653 0.00798 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 # with random effects, fixed effects not scaled mod5 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth + inlet_dist + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry(), ziformula = ~., family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation summary(mod5) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ Depth + inlet_dist + (1 | Site) + (1 | trip_wr) ## Zero inflation: ~. ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() ## ## AIC BIC logLik deviance df.resid ## -3296.2 -3240.0 1659.1 -3318.2 1209 ## ## Random effects: ## ## Conditional model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 9877.5 99.39 ## trip_wr (Intercept) 707.5 26.60 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Zero-inflation model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 0.2912 0.5397 ## trip_wr (Intercept) 0.1374 0.3707 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Dispersion estimate for Gamma family (sigma^2): 1.16 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 186.389207 51.764335 3.601 0.000317 *** ## Depth -2.928104 5.942242 -0.493 0.622182 ## inlet_dist 0.003014 0.106927 0.028 0.977514 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -0.695096 0.342083 -2.032 0.04216 * ## Depth 0.244920 0.082758 2.959 0.00308 ** ## inlet_dist 0.003043 0.002034 1.496 0.13465 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 # equal probability of structural zeros, scaled predictors mod6 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~1, family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation summary(mod6) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ Depth_scale + inlet_dist_scale + (1 | Site) + (1 | trip_wr) ## Zero inflation: ~1 ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -3252.9 -3217.2 1633.5 -3266.9 1213 ## ## Random effects: ## ## Conditional model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 9877.6 99.39 ## trip_wr (Intercept) 707.5 26.60 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Dispersion estimate for Gamma family (sigma^2): 1.16 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 182.4619 51.2840 3.558 0.000374 *** ## Depth_scale -2.7553 5.5913 -0.493 0.622169 ## inlet_dist_scale 0.1645 5.8306 0.028 0.977495 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.009836 0.057261 0.172 0.864 # equal probability of structural zeros, predictors not scaled mod7 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth + inlet_dist + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~1, family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation summary(mod7) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ Depth + inlet_dist + (1 | Site) + (1 | trip_wr) ## Zero inflation: ~1 ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -3252.9 -3217.2 1633.5 -3266.9 1213 ## ## Random effects: ## ## Conditional model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 9877.5 99.39 ## trip_wr (Intercept) 707.5 26.60 ## Number of obs: 1220, groups: Site, 4; trip_wr, 9 ## ## Dispersion estimate for Gamma family (sigma^2): 1.16 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 186.388879 51.764427 3.601 0.000317 *** ## Depth -2.928227 5.942234 -0.493 0.622167 ## inlet_dist 0.003012 0.106927 0.028 0.977529 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.009838 0.057261 0.172 0.864 # model selection fixed effects hurd1 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth + inlet_dist + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~1, family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation hurd2 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ Depth + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~1, family = ziGamma) hurd3 &lt;- glmmTMB(ch4_eb_g_m2_hr ~ inlet_dist + (1|Site) + (1|trip_wr), data = eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr)==F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)), ziformula = ~1, family = ziGamma) ## Warning in (function (start, objective, gradient = NULL, hessian = NULL, : NA/NaN function evaluation cand.models &lt;- list() cand.models[[1]] &lt;- hurd1 cand.models[[2]] &lt;- hurd2 cand.models[[3]] &lt;- hurd3 aictab(cand.models) ## Warning in aictab.AICglmmTMB(cand.models): ## Model names have been supplied automatically in the table ## ## Model selection based on AICc: ## ## K AICc Delta_AICc AICcWt Cum.Wt LL ## Mod3 6 -3270.88 0.00 1 1 1641.48 ## Mod2 6 -3254.85 16.03 0 1 1633.46 ## Mod1 7 -3252.83 18.05 0 1 1633.46 summary(hurd3) ## Family: Gamma ( inverse ) ## Formula: ch4_eb_g_m2_hr ~ inlet_dist + (1 | Site) + (1 | trip_wr) ## Zero inflation: ~1 ## Data: eb_all %&gt;% filter(is.na(ch4_eb_g_m2_hr) == F) %&gt;% st_drop_geometry() %&gt;% mutate(Depth_scale = scale(Depth), inlet_dist_scale = scale(inlet_dist)) ## ## AIC BIC logLik deviance df.resid ## -3271.0 -3240.3 1641.5 -3283.0 1217 ## ## Random effects: ## ## Conditional model: ## Groups Name Variance Std.Dev. ## Site (Intercept) 9553 97.74 ## trip_wr (Intercept) 735 27.11 ## Number of obs: 1223, groups: Site, 4; trip_wr, 9 ## ## Dispersion estimate for Gamma family (sigma^2): 1.16 ## ## Conditional model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 184.65157 50.86833 3.630 0.000283 *** ## inlet_dist -0.02671 0.08456 -0.316 0.752120 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Zero-inflation model: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.004905 0.057190 0.086 0.932 "]]
