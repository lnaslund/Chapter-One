<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Simple kriging just in space | Naslund Chapter 1 Analysis</title>
  <meta name="description" content="This is the documentation of an analysis of spatial and temporal variability of greenhouse gas emissions from small reservoirs" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Simple kriging just in space | Naslund Chapter 1 Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the documentation of an analysis of spatial and temporal variability of greenhouse gas emissions from small reservoirs" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Simple kriging just in space | Naslund Chapter 1 Analysis" />
  
  <meta name="twitter:description" content="This is the documentation of an analysis of spatial and temporal variability of greenhouse gas emissions from small reservoirs" />
  

<meta name="author" content="Laura Naslund" />


<meta name="date" content="2023-05-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ebullition.html"/>
<link rel="next" href="ebullition-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Naslund Chapter 1 Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sampling scheme</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#dissolved-oxygen"><i class="fa fa-check"></i><b>1.1</b> Dissolved oxygen</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#deans"><i class="fa fa-check"></i><b>1.1.1</b> Deans</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#catfish"><i class="fa fa-check"></i><b>1.1.2</b> Catfish</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#sister"><i class="fa fa-check"></i><b>1.1.3</b> Sister</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#blue-herron"><i class="fa fa-check"></i><b>1.1.4</b> Blue Herron</a></li>
<li class="chapter" data-level="1.1.5" data-path="index.html"><a href="index.html#all-impoundments-top-do"><i class="fa fa-check"></i><b>1.1.5</b> All impoundments top DO</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#temperature"><i class="fa fa-check"></i><b>1.2</b> Temperature</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#catfish-1"><i class="fa fa-check"></i><b>1.2.1</b> Catfish</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#sister-3"><i class="fa fa-check"></i><b>1.2.2</b> Sister 3</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#blue-herron-1"><i class="fa fa-check"></i><b>1.2.3</b> Blue Herron</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#par"><i class="fa fa-check"></i><b>1.3</b> PAR</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#deans-1"><i class="fa fa-check"></i><b>1.3.1</b> Deans</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#catfish-2"><i class="fa fa-check"></i><b>1.3.2</b> Catfish</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#pick"><i class="fa fa-check"></i><b>1.3.3</b> Pick</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#sister3"><i class="fa fa-check"></i><b>1.3.4</b> Sister3</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#dissolved-gas-concentrations"><i class="fa fa-check"></i><b>1.4</b> Dissolved gas concentrations</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#wind-speed"><i class="fa fa-check"></i><b>1.5</b> Wind Speed</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#residence-time-calculation"><i class="fa fa-check"></i><b>1.6</b> Residence time calculation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html"><i class="fa fa-check"></i><b>2</b> Diffusive emissions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#deans-diffusive-81622-81722"><i class="fa fa-check"></i><b>2.1</b> Deans Diffusive 8/16/22-8/17/22</a></li>
<li class="chapter" data-level="2.2" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#deans-diffusive-83022-83122"><i class="fa fa-check"></i><b>2.2</b> Deans Diffusive 8/30/22-8/31/22</a></li>
<li class="chapter" data-level="2.3" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#deans-cloud-comparison"><i class="fa fa-check"></i><b>2.3</b> Deans Cloud Comparison</a></li>
<li class="chapter" data-level="2.4" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#catfish-diffusive-9622-9722"><i class="fa fa-check"></i><b>2.4</b> Catfish Diffusive 9/6/22-9/7/22</a></li>
<li class="chapter" data-level="2.5" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#catfish-diffusive-91822-91922"><i class="fa fa-check"></i><b>2.5</b> Catfish Diffusive 9/18/22-9/19/22</a></li>
<li class="chapter" data-level="2.6" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#catfish-cloud-comparison"><i class="fa fa-check"></i><b>2.6</b> Catfish Cloud Comparison</a></li>
<li class="chapter" data-level="2.7" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#pick-diffusive-91322--91422"><i class="fa fa-check"></i><b>2.7</b> Pick Diffusive 9/13/22- 9/14/22</a></li>
<li class="chapter" data-level="2.8" data-path="diffusive-emissions.html"><a href="diffusive-emissions.html#sister3-diffusive-82222-82322"><i class="fa fa-check"></i><b>2.8</b> Sister3 Diffusive 8/22/22-8/23/22</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ebullition.html"><a href="ebullition.html"><i class="fa fa-check"></i><b>3</b> Ebullition</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ebullition.html"><a href="ebullition.html#deans-ebullitive-81622-81722"><i class="fa fa-check"></i><b>3.1</b> Deans Ebullitive 8/16/22-8/17/22</a></li>
<li class="chapter" data-level="3.2" data-path="ebullition.html"><a href="ebullition.html#deans-ebullitive-83022-83122"><i class="fa fa-check"></i><b>3.2</b> Deans Ebullitive 8/30/22-8/31/22</a></li>
<li class="chapter" data-level="3.3" data-path="ebullition.html"><a href="ebullition.html#catfish-ebullitive-90622-90722"><i class="fa fa-check"></i><b>3.3</b> Catfish Ebullitive 9/06/22-9/07/22</a></li>
<li class="chapter" data-level="3.4" data-path="ebullition.html"><a href="ebullition.html#catfish-ebullitive-91822-91922"><i class="fa fa-check"></i><b>3.4</b> Catfish Ebullitive 9/18/22-9/19/22</a></li>
<li class="chapter" data-level="3.5" data-path="ebullition.html"><a href="ebullition.html#pick-ebullitive-91322-91422"><i class="fa fa-check"></i><b>3.5</b> Pick Ebullitive 9/13/22-9/14/22</a></li>
<li class="chapter" data-level="3.6" data-path="ebullition.html"><a href="ebullition.html#sister-ebullitive-3-82222-82322"><i class="fa fa-check"></i><b>3.6</b> Sister Ebullitive 3 8/22/22-8/23/22</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-kriging-just-in-space.html"><a href="simple-kriging-just-in-space.html"><i class="fa fa-check"></i><b>4</b> Simple kriging just in space</a></li>
<li class="chapter" data-level="5" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html"><i class="fa fa-check"></i><b>5</b> Ebullition Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#plots"><i class="fa fa-check"></i><b>5.1</b> Plots</a></li>
<li class="chapter" data-level="5.2" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod1-non-zero-data-fixed-effects-only"><i class="fa fa-check"></i><b>5.2</b> Mod1: Non-zero data, fixed effects only</a></li>
<li class="chapter" data-level="5.3" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod2-non-zero-data-mixed-model"><i class="fa fa-check"></i><b>5.3</b> Mod2: Non zero data, mixed model</a></li>
<li class="chapter" data-level="5.4" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod2.a-non-zero-data-mixed-model-without-picks"><i class="fa fa-check"></i><b>5.4</b> Mod2.a: Non zero data, mixed model without Picks</a></li>
<li class="chapter" data-level="5.5" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod2.b-non-zero-data-mixed-model-only-picks"><i class="fa fa-check"></i><b>5.5</b> Mod2.b: Non zero data, mixed model only Picks</a></li>
<li class="chapter" data-level="5.6" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod3-logistic-regression-fixed-effects-only"><i class="fa fa-check"></i><b>5.6</b> Mod3: Logistic regression, fixed effects only</a></li>
<li class="chapter" data-level="5.7" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod4-logistic-regression-mixed-model"><i class="fa fa-check"></i><b>5.7</b> Mod4: Logistic regression, mixed model</a></li>
<li class="chapter" data-level="5.8" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod4.a-logistic-regression-mixed-model-without-picks"><i class="fa fa-check"></i><b>5.8</b> Mod4.a: Logistic regression, mixed model without Picks</a></li>
<li class="chapter" data-level="5.9" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod4.b-logistic-regression-mixed-model-only-picks"><i class="fa fa-check"></i><b>5.9</b> Mod4.b: Logistic regression, mixed model only Picks</a></li>
<li class="chapter" data-level="5.10" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod5-hurdle-model-predictors-generate-structural-zeros"><i class="fa fa-check"></i><b>5.10</b> Mod5: Hurdle model, predictors generate structural zeros</a></li>
<li class="chapter" data-level="5.11" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#model-selection-with-mod5-predictors"><i class="fa fa-check"></i><b>5.11</b> Model selection with Mod5 predictors</a></li>
<li class="chapter" data-level="5.12" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod6-hurdle-model-equal-probability-of-structural-zeros"><i class="fa fa-check"></i><b>5.12</b> Mod6: Hurdle model, equal probability of structural zeros</a></li>
<li class="chapter" data-level="5.13" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#mod7-not-broken-up-by-time-no-longer-zero-inflated-sampling-random-effect"><i class="fa fa-check"></i><b>5.13</b> Mod7: Not broken up by time, no longer zero-inflated, sampling random effect</a></li>
<li class="chapter" data-level="5.14" data-path="ebullition-analysis.html"><a href="ebullition-analysis.html#by-transect"><i class="fa fa-check"></i><b>5.14</b> By transect</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="diffusion-estimates.html"><a href="diffusion-estimates.html"><i class="fa fa-check"></i><b>6</b> Diffusion estimates</a></li>
<li class="chapter" data-level="7" data-path="ebullition-estimates.html"><a href="ebullition-estimates.html"><i class="fa fa-check"></i><b>7</b> Ebullition estimates</a></li>
<li class="chapter" data-level="8" data-path="flux-summary-stats-prep.html"><a href="flux-summary-stats-prep.html"><i class="fa fa-check"></i><b>8</b> Flux summary stats prep</a></li>
<li class="chapter" data-level="9" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html"><i class="fa fa-check"></i><b>9</b> Total flux estimates</a>
<ul>
<li class="chapter" data-level="9.1" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#summary-flux-table-masses-and-rates"><i class="fa fa-check"></i><b>9.1</b> Summary flux table masses and rates</a></li>
<li class="chapter" data-level="9.2" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#summary-table-co2-eq"><i class="fa fa-check"></i><b>9.2</b> Summary Table CO2-eq</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#pathway"><i class="fa fa-check"></i><b>9.2.1</b> Pathway</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#diel-diffusive-ch4"><i class="fa fa-check"></i><b>9.3</b> Diel Diffusive CH4</a></li>
<li class="chapter" data-level="9.4" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#diel-diffusive-co2"><i class="fa fa-check"></i><b>9.4</b> Diel Diffusive CO2</a></li>
<li class="chapter" data-level="9.5" data-path="total-flux-estimates.html"><a href="total-flux-estimates.html#diel-ebullition"><i class="fa fa-check"></i><b>9.5</b> Diel ebullition</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sunny-cloudy-analysis.html"><a href="sunny-cloudy-analysis.html"><i class="fa fa-check"></i><b>10</b> Sunny Cloudy Analysis</a></li>
<li class="chapter" data-level="11" data-path="degassing-analysis.html"><a href="degassing-analysis.html"><i class="fa fa-check"></i><b>11</b> Degassing analysis</a></li>
<li class="chapter" data-level="12" data-path="alternative-sampling-scheme-simulations.html"><a href="alternative-sampling-scheme-simulations.html"><i class="fa fa-check"></i><b>12</b> Alternative sampling scheme simulations</a></li>
<li class="chapter" data-level="13" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html"><i class="fa fa-check"></i><b>13</b> Analyses of patterns of diel diffusive emissions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#diel-patterns-in-environmental-variables"><i class="fa fa-check"></i><b>13.1</b> Diel patterns in environmental variables</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#weather-station-hourly-windspeed-from-aug-14---sept-19"><i class="fa fa-check"></i><b>13.1.1</b> Weather station hourly windspeed from Aug 14 - Sept 19</a></li>
<li class="chapter" data-level="13.1.2" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#dissolved-oxygen-1"><i class="fa fa-check"></i><b>13.1.2</b> Dissolved oxygen</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#ch4-models"><i class="fa fa-check"></i><b>13.2</b> CH4 models</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#windspeed-with-handheld-anemometer"><i class="fa fa-check"></i><b>13.2.1</b> windspeed with handheld anemometer</a></li>
<li class="chapter" data-level="13.2.2" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#light"><i class="fa fa-check"></i><b>13.2.2</b> Light</a></li>
<li class="chapter" data-level="13.2.3" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#temperature-1"><i class="fa fa-check"></i><b>13.2.3</b> Temperature</a></li>
<li class="chapter" data-level="13.2.4" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#dissolved-oxygen-2"><i class="fa fa-check"></i><b>13.2.4</b> Dissolved oxygen</a></li>
<li class="chapter" data-level="13.2.5" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#multiple-predictors"><i class="fa fa-check"></i><b>13.2.5</b> Multiple predictors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#co2-models"><i class="fa fa-check"></i><b>13.3</b> CO2 models</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#windspeed-with-handheld-anemometer-1"><i class="fa fa-check"></i><b>13.3.1</b> windspeed with handheld anemometer</a></li>
<li class="chapter" data-level="13.3.2" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#light-1"><i class="fa fa-check"></i><b>13.3.2</b> Light</a></li>
<li class="chapter" data-level="13.3.3" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#temperature-2"><i class="fa fa-check"></i><b>13.3.3</b> Temperature</a></li>
<li class="chapter" data-level="13.3.4" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#dissolved-oxygen-3"><i class="fa fa-check"></i><b>13.3.4</b> Dissolved oxygen</a></li>
<li class="chapter" data-level="13.3.5" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#multiple-predictors-1"><i class="fa fa-check"></i><b>13.3.5</b> Multiple predictors</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#ch4-plots"><i class="fa fa-check"></i><b>13.4</b> CH4 plots</a></li>
<li class="chapter" data-level="13.5" data-path="analyses-of-patterns-of-diel-diffusive-emissions.html"><a href="analyses-of-patterns-of-diel-diffusive-emissions.html#co2-plots"><i class="fa fa-check"></i><b>13.5</b> CO2 plots</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="outputs.html"><a href="outputs.html"><i class="fa fa-check"></i><b>14</b> Outputs</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Naslund Chapter 1 Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-kriging-just-in-space" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Simple kriging just in space<a href="simple-kriging-just-in-space.html#simple-kriging-just-in-space" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="simple-kriging-just-in-space.html#cb33-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> pick_pts_13 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(trip <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb33-2"><a href="simple-kriging-just-in-space.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="simple-kriging-just-in-space.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create x y trend model and pull residuals to krige</span></span>
<span id="cb33-4"><a href="simple-kriging-just-in-space.html#cb33-4" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(X)</span>
<span id="cb33-5"><a href="simple-kriging-just-in-space.html#cb33-5" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Y)</span>
<span id="cb33-6"><a href="simple-kriging-just-in-space.html#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="simple-kriging-just-in-space.html#cb33-7" aria-hidden="true" tabindex="-1"></a>func_trend <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(flux_co2_g_hr <span class="sc">~</span> x <span class="sc">+</span> y)</span>
<span id="cb33-8"><a href="simple-kriging-just-in-space.html#cb33-8" aria-hidden="true" tabindex="-1"></a>lm_trend <span class="ot">&lt;-</span> <span class="fu">lm</span>(func_trend, <span class="at">data =</span> test_data)</span>
<span id="cb33-9"><a href="simple-kriging-just-in-space.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="simple-kriging-just-in-space.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_trend)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = func_trend, data = test_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.52583 -0.10096 -0.02899  0.21436  0.41754 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  4.815e+04  3.024e+04   1.593   0.1457  
## x           -1.999e-02  7.032e-03  -2.842   0.0193 *
## y           -1.130e-02  7.539e-03  -1.499   0.1680  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3229 on 9 degrees of freedom
## Multiple R-squared:  0.7654, Adjusted R-squared:  0.7132 
## F-statistic: 14.68 on 2 and 9 DF,  p-value: 0.001468</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="simple-kriging-just-in-space.html#cb35-1" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>resid_co2_g_hr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_trend)</span>
<span id="cb35-2"><a href="simple-kriging-just-in-space.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="simple-kriging-just-in-space.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(test_data<span class="sc">$</span>resid_co2_g_hr)</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="simple-kriging-just-in-space.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to return table with normal scores and original values to use for backtransform later</span></span>
<span id="cb36-2"><a href="simple-kriging-just-in-space.html#cb36-2" aria-hidden="true" tabindex="-1"></a>nscore <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {                       </span>
<span id="cb36-3"><a href="simple-kriging-just-in-space.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  nscore <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(x, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x  <span class="co"># normal score </span></span>
<span id="cb36-4"><a href="simple-kriging-just-in-space.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  trn.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">sort</span>(x),<span class="at">nscore=</span><span class="fu">sort</span>(nscore))</span>
<span id="cb36-5"><a href="simple-kriging-just-in-space.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (trn.table)</span>
<span id="cb36-6"><a href="simple-kriging-just-in-space.html#cb36-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-7"><a href="simple-kriging-just-in-space.html#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="simple-kriging-just-in-space.html#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># quantile-quantile normal score transform data</span></span>
<span id="cb36-9"><a href="simple-kriging-just-in-space.html#cb36-9" aria-hidden="true" tabindex="-1"></a>test_data<span class="sc">$</span>resid_norm_co2_g_hr <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(test_data<span class="sc">$</span>resid_co2_g_hr, <span class="at">plot.it =</span> F)<span class="sc">$</span>x</span>
<span id="cb36-10"><a href="simple-kriging-just-in-space.html#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="simple-kriging-just-in-space.html#cb36-11" aria-hidden="true" tabindex="-1"></a>nscore.tab <span class="ot">&lt;-</span> <span class="fu">nscore</span>(test_data<span class="sc">$</span>resid_co2_g_hr)</span>
<span id="cb36-12"><a href="simple-kriging-just-in-space.html#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="simple-kriging-just-in-space.html#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x<span class="sc">~</span>nscore, <span class="at">data=</span>nscore.tab)</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-2.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="simple-kriging-just-in-space.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(test_data<span class="sc">$</span>resid_co2_g_hr))</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-3.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="simple-kriging-just-in-space.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(test_data<span class="sc">$</span>resid_norm_co2_g_hr))</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-4.png" width="672" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="simple-kriging-just-in-space.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(test_data<span class="sc">$</span>resid_co2_g_hr)</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-5.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="simple-kriging-just-in-space.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(test_data<span class="sc">$</span>resid_norm_co2_g_hr)</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-6.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="simple-kriging-just-in-space.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(pick)<span class="sc">+</span></span>
<span id="cb41-2"><a href="simple-kriging-just-in-space.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb41-3"><a href="simple-kriging-just-in-space.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(test_data)<span class="sc">+</span></span>
<span id="cb41-4"><a href="simple-kriging-just-in-space.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">&quot;resid_norm_co2_g_hr&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">palette =</span> <span class="st">&quot;-RdYlBu&quot;</span>, <span class="at">midpoint =</span> <span class="cn">NA</span>, <span class="at">title =</span> <span class="st">&quot;Normalized CO2 residual (g/m2/hr)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/transform%20data-7.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="simple-kriging-just-in-space.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create isotropic variogram</span></span>
<span id="cb42-2"><a href="simple-kriging-just-in-space.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># width = lag distance (approximately minimum non zero data spacing)</span></span>
<span id="cb42-3"><a href="simple-kriging-just-in-space.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cutoff = number of lags * lag distance (number of lags = 1/2 major axis/lag distance)</span></span>
<span id="cb42-4"><a href="simple-kriging-just-in-space.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># think about how cutoff and width parameters are impacting variogram calculation</span></span>
<span id="cb42-5"><a href="simple-kriging-just-in-space.html#cb42-5" aria-hidden="true" tabindex="-1"></a>var.norm.iso <span class="ot">&lt;-</span> <span class="fu">variogram</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>, test_data ,<span class="at">cutoff =</span> <span class="dv">70</span> ,<span class="at">width =</span> <span class="dv">14</span>)</span>
<span id="cb42-6"><a href="simple-kriging-just-in-space.html#cb42-6" aria-hidden="true" tabindex="-1"></a>var.norm.th.iso <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="st">&quot;Exp&quot;</span>, <span class="at">range =</span> <span class="dv">17</span>) <span class="co"># no nugget</span></span>
<span id="cb42-7"><a href="simple-kriging-just-in-space.html#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="simple-kriging-just-in-space.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot theoretical with experimental variogram</span></span>
<span id="cb42-9"><a href="simple-kriging-just-in-space.html#cb42-9" aria-hidden="true" tabindex="-1"></a>vm.norm.sim <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(var.norm.th.iso,<span class="at">maxdist=</span><span class="dv">100</span>,<span class="at">min=</span><span class="fl">0.0001</span>,<span class="at">n=</span><span class="dv">100</span>, <span class="at">covariance=</span><span class="cn">FALSE</span>)</span>
<span id="cb42-10"><a href="simple-kriging-just-in-space.html#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(var.norm.iso<span class="sc">$</span>dist,var.norm.iso<span class="sc">$</span>gamma, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb42-11"><a href="simple-kriging-just-in-space.html#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(vm.norm.sim<span class="sc">$</span>dist,vm.norm.sim<span class="sc">$</span>gamma,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/variograms-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="simple-kriging-just-in-space.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create anisotropic variogram (doesn&#39;t appear to be enough data to do this/not well supported with residuals of gaussian transformed model)</span></span>
<span id="cb43-2"><a href="simple-kriging-just-in-space.html#cb43-2" aria-hidden="true" tabindex="-1"></a>var.norm<span class="fl">.045</span> <span class="ot">=</span> <span class="fu">variogram</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>,test_data,<span class="at">cutoff =</span> <span class="dv">70</span>,<span class="at">width =</span><span class="dv">14</span>,<span class="at">alpha =</span> <span class="fl">45.0</span>,<span class="at">tol.hor=</span><span class="fl">22.5</span>) <span class="co"># 045 directional </span></span>
<span id="cb43-3"><a href="simple-kriging-just-in-space.html#cb43-3" aria-hidden="true" tabindex="-1"></a>var.norm<span class="fl">.135</span> <span class="ot">=</span> <span class="fu">variogram</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>,test_data,<span class="at">cutoff =</span> <span class="dv">70</span>,<span class="at">width =</span><span class="dv">14</span>,<span class="at">alpha =</span> <span class="fl">135.0</span>,<span class="at">tol.hor=</span><span class="fl">22.5</span>) <span class="co"># 135 directional</span></span>
<span id="cb43-4"><a href="simple-kriging-just-in-space.html#cb43-4" aria-hidden="true" tabindex="-1"></a>var.norm.th.ani<span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">17</span>, <span class="at">anis =</span> <span class="fu">c</span>(<span class="dv">135</span>, <span class="fl">0.5</span>))</span>
<span id="cb43-5"><a href="simple-kriging-just-in-space.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="simple-kriging-just-in-space.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot theoretical anisotropic variograms with experimental variograms</span></span>
<span id="cb43-7"><a href="simple-kriging-just-in-space.html#cb43-7" aria-hidden="true" tabindex="-1"></a>unit_vector <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sin</span>(<span class="dv">45</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>),<span class="fu">sin</span>(<span class="dv">45</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>),<span class="dv">0</span>) <span class="co"># unit vector for 035 azimuth</span></span>
<span id="cb43-8"><a href="simple-kriging-just-in-space.html#cb43-8" aria-hidden="true" tabindex="-1"></a>vm.norm.sim.an<span class="fl">.45</span> <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(var.norm.th.ani, <span class="at">maxdist=</span><span class="dv">100</span>,<span class="at">min=</span><span class="fl">0.0001</span>,<span class="at">n=</span><span class="dv">100</span>, <span class="at">covariance=</span><span class="cn">FALSE</span>, <span class="at">dir=</span>unit_vector)</span>
<span id="cb43-9"><a href="simple-kriging-just-in-space.html#cb43-9" aria-hidden="true" tabindex="-1"></a>unit_vector <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sin</span>(<span class="dv">45</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>),<span class="sc">-</span><span class="fu">sin</span>(<span class="dv">45</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>),<span class="dv">0</span>) <span class="co"># unit vector for 035 azimuth</span></span>
<span id="cb43-10"><a href="simple-kriging-just-in-space.html#cb43-10" aria-hidden="true" tabindex="-1"></a>vm.norm.sim.an<span class="fl">.135</span> <span class="ot">&lt;-</span> <span class="fu">variogramLine</span>(var.norm.th.ani, <span class="at">maxdist=</span><span class="dv">100</span>,<span class="at">min=</span><span class="fl">0.0001</span>,<span class="at">n=</span><span class="dv">100</span>, <span class="at">covariance=</span><span class="cn">FALSE</span>, <span class="at">dir=</span>unit_vector)</span>
<span id="cb43-11"><a href="simple-kriging-just-in-space.html#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="simple-kriging-just-in-space.html#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="simple-kriging-just-in-space.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(var.norm<span class="fl">.135</span><span class="sc">$</span>dist, var.norm<span class="fl">.135</span><span class="sc">$</span>gamma, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb43-14"><a href="simple-kriging-just-in-space.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(var.norm<span class="fl">.045</span><span class="sc">$</span>dist, var.norm<span class="fl">.045</span><span class="sc">$</span>gamma, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb43-15"><a href="simple-kriging-just-in-space.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(vm.norm.sim.an<span class="fl">.45</span><span class="sc">$</span>dist, vm.norm.sim.an<span class="fl">.45</span><span class="sc">$</span>gamma, <span class="at">col =</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb43-16"><a href="simple-kriging-just-in-space.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(vm.norm.sim.an<span class="fl">.135</span><span class="sc">$</span>dist, vm.norm.sim.an<span class="fl">.135</span><span class="sc">$</span>gamma, <span class="at">col =</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/variograms-2.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="simple-kriging-just-in-space.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create interpolation grid</span></span>
<span id="cb44-2"><a href="simple-kriging-just-in-space.html#cb44-2" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">st_as_stars</span>(<span class="fu">st_bbox</span>(pick), <span class="at">dx =</span> <span class="dv">1</span>, <span class="at">dy =</span> <span class="dv">1</span>)</span>
<span id="cb44-3"><a href="simple-kriging-just-in-space.html#cb44-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid[pick]</span>
<span id="cb44-4"><a href="simple-kriging-just-in-space.html#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="simple-kriging-just-in-space.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ordinary kriging (assumption of stationarity of the mean is relaxed, mean is estimated locally)</span></span>
<span id="cb44-6"><a href="simple-kriging-just-in-space.html#cb44-6" aria-hidden="true" tabindex="-1"></a>co2.kriged <span class="ot">=</span> <span class="fu">krige</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>, test_data, grid, <span class="at">model =</span> var.norm.th.iso,<span class="at">maxdist =</span> <span class="cn">Inf</span>,<span class="at">nmin =</span> <span class="dv">0</span>,<span class="at">omax=</span><span class="cn">Inf</span>) </span></code></pre></div>
<pre><code>## Warning in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, : NAs introduced by coercion to integer range</code></pre>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="simple-kriging-just-in-space.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple kriging (mean is stationary)</span></span>
<span id="cb47-2"><a href="simple-kriging-just-in-space.html#cb47-2" aria-hidden="true" tabindex="-1"></a>co2.kriged.sk <span class="ot">=</span> <span class="fu">krige</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>, test_data, grid, <span class="at">model =</span> var.norm.th.iso,<span class="at">maxdist =</span> <span class="cn">Inf</span>,<span class="at">nmin =</span> <span class="dv">0</span>,<span class="at">omax=</span><span class="cn">Inf</span>, <span class="at">beta =</span> <span class="fu">mean</span>(test_data<span class="sc">$</span>resid_norm_co2_g_hr)) </span></code></pre></div>
<pre><code>## Warning in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, : NAs introduced by coercion to integer range</code></pre>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="simple-kriging-just-in-space.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ordinary and simple kriging (yield very similar results in this example)</span></span>
<span id="cb50-2"><a href="simple-kriging-just-in-space.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(co2.kriged<span class="sc">$</span>var1.pred, <span class="at">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] -1.676307  1.670763</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="simple-kriging-just-in-space.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(co2.kriged.sk<span class="sc">$</span>var1.pred, <span class="at">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] -1.675864  1.670890</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="simple-kriging-just-in-space.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co2.kriged.sk)</span></code></pre></div>
<p><img src="_main_files/figure-html/kriging%20with%20isotropic%20variogram-1.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="simple-kriging-just-in-space.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backtransform normal scores</span></span>
<span id="cb55-2"><a href="simple-kriging-just-in-space.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># based on the gslib documentation, it looks like what you need to do is for each point interpolate between points in the normal score table and use an extrapolation function (possibly linear?) for points beyond the range</span></span>
<span id="cb55-3"><a href="simple-kriging-just-in-space.html#cb55-3" aria-hidden="true" tabindex="-1"></a>above.max.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(x<span class="sc">~</span>nscore, <span class="at">data=</span>nscore.tab[(<span class="fu">nrow</span>(nscore.tab)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(nscore.tab),])</span>
<span id="cb55-4"><a href="simple-kriging-just-in-space.html#cb55-4" aria-hidden="true" tabindex="-1"></a>above.max.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb55-5"><a href="simple-kriging-just-in-space.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>(above.max.lm)[[<span class="dv">1</span>]] <span class="sc">+</span> (<span class="fu">coefficients</span>(above.max.lm)[[<span class="dv">2</span>]]<span class="sc">*</span>x)</span>
<span id="cb55-6"><a href="simple-kriging-just-in-space.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-7"><a href="simple-kriging-just-in-space.html#cb55-7" aria-hidden="true" tabindex="-1"></a>below.min.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(x<span class="sc">~</span>nscore, <span class="at">data=</span>nscore.tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,])</span>
<span id="cb55-8"><a href="simple-kriging-just-in-space.html#cb55-8" aria-hidden="true" tabindex="-1"></a>below.min.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb55-9"><a href="simple-kriging-just-in-space.html#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>(below.min.lm)[[<span class="dv">1</span>]] <span class="sc">+</span> (<span class="fu">coefficients</span>(below.min.lm)[[<span class="dv">2</span>]]<span class="sc">*</span>x)</span>
<span id="cb55-10"><a href="simple-kriging-just-in-space.html#cb55-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-11"><a href="simple-kriging-just-in-space.html#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="simple-kriging-just-in-space.html#cb55-12" aria-hidden="true" tabindex="-1"></a>interpolate <span class="ot">&lt;-</span> <span class="fu">approxfun</span>(<span class="at">x=</span>nscore.tab<span class="sc">$</span>nscore, <span class="at">y=</span>nscore.tab<span class="sc">$</span>x)</span>
<span id="cb55-13"><a href="simple-kriging-just-in-space.html#cb55-13" aria-hidden="true" tabindex="-1"></a>backtr <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb55-14"><a href="simple-kriging-just-in-space.html#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(x)){</span>
<span id="cb55-15"><a href="simple-kriging-just-in-space.html#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb55-16"><a href="simple-kriging-just-in-space.html#cb55-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-17"><a href="simple-kriging-just-in-space.html#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&gt;</span><span class="fu">max</span>(nscore.tab<span class="sc">$</span>nscore)){</span>
<span id="cb55-18"><a href="simple-kriging-just-in-space.html#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">above.max.func</span>(x))</span>
<span id="cb55-19"><a href="simple-kriging-just-in-space.html#cb55-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-20"><a href="simple-kriging-just-in-space.html#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&lt;</span><span class="fu">min</span>(nscore.tab<span class="sc">$</span>nscore)){</span>
<span id="cb55-21"><a href="simple-kriging-just-in-space.html#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">below.min.func</span>(x))</span>
<span id="cb55-22"><a href="simple-kriging-just-in-space.html#cb55-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-23"><a href="simple-kriging-just-in-space.html#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb55-24"><a href="simple-kriging-just-in-space.html#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">interpolate</span>(x))</span>
<span id="cb55-25"><a href="simple-kriging-just-in-space.html#cb55-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-26"><a href="simple-kriging-just-in-space.html#cb55-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-27"><a href="simple-kriging-just-in-space.html#cb55-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-28"><a href="simple-kriging-just-in-space.html#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="simple-kriging-just-in-space.html#cb55-29" aria-hidden="true" tabindex="-1"></a>co2.kriged.sk<span class="sc">$</span>backtransformed <span class="ot">&lt;-</span> <span class="fu">apply</span>(co2.kriged.sk<span class="sc">$</span>var1.pred, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, backtr)</span>
<span id="cb55-30"><a href="simple-kriging-just-in-space.html#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="simple-kriging-just-in-space.html#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="co"># add back in the trend to the kriged backtransformed residuals</span></span>
<span id="cb55-32"><a href="simple-kriging-just-in-space.html#cb55-32" aria-hidden="true" tabindex="-1"></a>co2.kriged.sk<span class="sc">$</span>trend <span class="ot">&lt;-</span> <span class="fu">predict</span>(co2.kriged.sk[<span class="dv">3</span>], lm_trend)</span>
<span id="cb55-33"><a href="simple-kriging-just-in-space.html#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="simple-kriging-just-in-space.html#cb55-34" aria-hidden="true" tabindex="-1"></a>co2.kriged.sk<span class="sc">$</span>detrended <span class="ot">&lt;-</span> co2.kriged.sk<span class="sc">$</span>trend <span class="sc">+</span> co2.kriged.sk<span class="sc">$</span>backtransformed</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="simple-kriging-just-in-space.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequential Gaussian simulation with isotropic variogram using simple kriging (but ordinary kriging also run)</span></span>
<span id="cb56-2"><a href="simple-kriging-just-in-space.html#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="simple-kriging-just-in-space.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ortiz 2020 https://qspace.library.queensu.ca/bitstream/handle/1974/28538/2020-01-Ortiz-Simulation.pdf?sequence=2 indicates that you shouldn&#39;t use ordinary kriging in sequential gaussian simulation. The krige function I think allows you to use ordinary kriging and it looks like it might be trying to estimate beta within the function. </span></span>
<span id="cb56-4"><a href="simple-kriging-just-in-space.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># co2.kriged.sim = krige(resid_norm_co2_g_hr~1, test_data, grid, model = var.norm.th.iso,maxdist = Inf,nmin = 0,omax=Inf, indicators=FALSE, nsim=2, nmax=100) # will take a second to run</span></span>
<span id="cb56-5"><a href="simple-kriging-just-in-space.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="simple-kriging-just-in-space.html#cb56-6" aria-hidden="true" tabindex="-1"></a>co2.kriged.sim.sk <span class="ot">=</span> <span class="fu">krige</span>(resid_norm_co2_g_hr<span class="sc">~</span><span class="dv">1</span>, test_data, grid, <span class="at">model =</span> var.norm.th.iso,<span class="at">maxdist =</span> <span class="cn">Inf</span>,<span class="at">nmin =</span> <span class="dv">0</span>,<span class="at">omax=</span><span class="cn">Inf</span>, <span class="at">indicators=</span><span class="cn">FALSE</span>, <span class="at">nsim=</span><span class="dv">2</span>, <span class="at">nmax=</span><span class="dv">100</span>, <span class="at">beta =</span> <span class="dv">0</span>) <span class="co"># will take a second to run # mean should be zero after gaussian transformation # I don&#39;t know if beta is required here</span></span></code></pre></div>
<pre><code>## Warning in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, : NAs introduced by coercion to integer range</code></pre>
<pre><code>## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="simple-kriging-just-in-space.html#cb59-1" aria-hidden="true" tabindex="-1"></a>co2.kriged.sim.sk<span class="sc">$</span>backtransform <span class="ot">&lt;-</span> <span class="fu">st_apply</span>(co2.kriged.sim.sk[<span class="dv">1</span>], <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, backtr)</span>
<span id="cb59-2"><a href="simple-kriging-just-in-space.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(co2.kriged.sim.sk)</span></code></pre></div>
<pre><code>## List of 2
##  $ var1         : num [1:220, 1:182, 1:2] NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;names&quot;)= chr [1:80080] &quot;sim11&quot; &quot;sim12&quot; &quot;sim13&quot; &quot;sim14&quot; ...
##  $ backtransform: num [1:220, 1:182, 1:2] NA NA NA NA NA NA NA NA NA NA ...
##  - attr(*, &quot;dimensions&quot;)=List of 3
##   ..$ x     :List of 7
##   .. ..$ from  : num 1
##   .. ..$ to    : int 220
##   .. ..$ offset: num 287504
##   .. ..$ delta : num 1
##   .. ..$ refsys:List of 2
##   .. .. ..$ input: chr &quot;EPSG:32617&quot;
##   .. .. ..$ wkt  : chr &quot;PROJCRS[\&quot;WGS 84 / UTM zone 17N\&quot;,\n    BASEGEOGCRS[\&quot;WGS 84\&quot;,\n        ENSEMBLE[\&quot;World Geodetic System 1984 &quot;| __truncated__
##   .. .. ..- attr(*, &quot;class&quot;)= chr &quot;crs&quot;
##   .. ..$ point : logi NA
##   .. ..$ values: NULL
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;dimension&quot;
##   ..$ y     :List of 7
##   .. ..$ from  : num 1
##   .. ..$ to    : int 182
##   .. ..$ offset: num 3752091
##   .. ..$ delta : num -1
##   .. ..$ refsys:List of 2
##   .. .. ..$ input: chr &quot;EPSG:32617&quot;
##   .. .. ..$ wkt  : chr &quot;PROJCRS[\&quot;WGS 84 / UTM zone 17N\&quot;,\n    BASEGEOGCRS[\&quot;WGS 84\&quot;,\n        ENSEMBLE[\&quot;World Geodetic System 1984 &quot;| __truncated__
##   .. .. ..- attr(*, &quot;class&quot;)= chr &quot;crs&quot;
##   .. ..$ point : logi NA
##   .. ..$ values: NULL
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;dimension&quot;
##   ..$ sample:List of 7
##   .. ..$ from  : num 1
##   .. ..$ to    : int 2
##   .. ..$ offset: num NA
##   .. ..$ delta : num NA
##   .. ..$ refsys: chr NA
##   .. ..$ point : logi NA
##   .. ..$ values: chr [1:2] &quot;sim1&quot; &quot;sim2&quot;
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;dimension&quot;
##   ..- attr(*, &quot;raster&quot;)=List of 4
##   .. ..$ affine     : num [1:2] 0 0
##   .. ..$ dimensions : chr [1:2] &quot;x&quot; &quot;y&quot;
##   .. ..$ curvilinear: logi FALSE
##   .. ..$ blocksizes : NULL
##   .. ..- attr(*, &quot;class&quot;)= chr &quot;stars_raster&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;dimensions&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;stars&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="simple-kriging-just-in-space.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co2.kriged.sim.sk[<span class="dv">1</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/simulation-1.png" width="672" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="simple-kriging-just-in-space.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co2.kriged.sim.sk[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/simulation-2.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="simple-kriging-just-in-space.html#cb63-1" aria-hidden="true" tabindex="-1"></a>co2.kriged.sim.sk<span class="sc">$</span>trend <span class="ot">&lt;-</span> <span class="fu">predict</span>(co2.kriged.sim.sk[<span class="dv">2</span>], lm_trend)</span>
<span id="cb63-2"><a href="simple-kriging-just-in-space.html#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="simple-kriging-just-in-space.html#cb63-3" aria-hidden="true" tabindex="-1"></a>co2.kriged.sim.sk<span class="sc">$</span>detrended <span class="ot">&lt;-</span> co2.kriged.sim.sk[<span class="dv">2</span>] <span class="sc">+</span> co2.kriged.sim.sk[<span class="dv">3</span>]</span>
<span id="cb63-4"><a href="simple-kriging-just-in-space.html#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="simple-kriging-just-in-space.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(co2.kriged.sim.sk[<span class="dv">4</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/simulation-3.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="simple-kriging-just-in-space.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total CO2 flux estimate (in grams) from simulations</span></span>
<span id="cb64-2"><a href="simple-kriging-just-in-space.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(co2.kriged.sim.sk[<span class="dv">4</span>,,,<span class="dv">1</span>]<span class="sc">$</span>detrended, <span class="at">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] 506.5057</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="simple-kriging-just-in-space.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(co2.kriged.sim.sk[<span class="dv">4</span>,,,<span class="dv">2</span>]<span class="sc">$</span>detrended, <span class="at">na.rm =</span> T)</span></code></pre></div>
<pre><code>## [1] 168.5491</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="simple-kriging-just-in-space.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># total CO2 flux estimate using only the mean of measured data values</span></span>
<span id="cb68-2"><a href="simple-kriging-just-in-space.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_area</span>(pick) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()<span class="sc">*</span><span class="fu">mean</span>(test_data<span class="sc">$</span>flux_co2_g_hr)</span></code></pre></div>
<pre><code>## [1] 702.4269</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="ebullition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ebullition-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-kriging.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
